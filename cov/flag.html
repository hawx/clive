<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>lib/clive/flag.rb</title>
    <link rel="stylesheet" href="styles.css" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="plugins.js"></script>
    <script type="text/javascript" src="main.js"></script>
  </head>
  <body>
  
    <header>
      <h1><a href="index.html">Coverage</a></h1>
      <h2>lib/clive/flag.rb</h2>
    </header>
    
    <div class="table-wrapper">
      <table class="summary" border="none">
        <thead>
          <tr>
            <th>Name</th>
            <th>Total Lines</th>
            <th>Lines of Code</th>
            <th>Total Coverage</th>
            <th>Code Coverage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="name">lib/clive/flag.rb</td>
            <td>96</td>
            <td>37</td>
            <td>37.50%</td>
            <td>97.30%</td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <div class="table-wrapper">
      <table class="source" border="none">
          <tr class="ran">
          <td class="no">0</td>
          <td><pre><code>class Clive</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">1</td>
          <td><pre><code>  </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">2</td>
          <td><pre><code>  # A switch that takes an argument, with or without an equals</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">3</td>
          <td><pre><code>  #   eg. wget --tries=10</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">4</td>
          <td><pre><code>  #       wget -t 10</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">5</td>
          <td><pre><code>  #</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">6</td>
          <td><pre><code>  class Flag < Option</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="ran">
          <td class="no">7</td>
          <td><pre><code>    attr_accessor :args</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">8</td>
          <td><pre><code>        </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">9</td>
          <td><pre><code>    # Creates a new Flag instance.</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">10</td>
          <td><pre><code>    #</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">11</td>
          <td><pre><code>    # +short+ _or_ +long+ can be omitted but not both.</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">12</td>
          <td><pre><code>    #</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">13</td>
          <td><pre><code>    # @overload flag(short, long, desc, &block)</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">14</td>
          <td><pre><code>    #   Creates a new flag</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">15</td>
          <td><pre><code>    #   @param [Symbol] short single character for short flag, eg. +:t+ => +-t 10+</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">16</td>
          <td><pre><code>    #   @param [Symbol] long longer switch to be used, eg. +:tries+ => +--tries=10+</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">17</td>
          <td><pre><code>    #   @param [String] desc the description for the flag</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">18</td>
          <td><pre><code>    #</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">19</td>
          <td><pre><code>    # @yield [String] A block to be run if switch is triggered</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">20</td>
          <td><pre><code>    #</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">21</td>
          <td><pre><code>    def initialize(*args, &block)</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="ran">
          <td class="no">22</td>
          <td><pre><code>      @names = []</code></pre></td>
          <td><span class="count">29</span></td>
        </tr>
          <tr class="ran">
          <td class="no">23</td>
          <td><pre><code>      @args  = []</code></pre></td>
          <td><span class="count">29</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">24</td>
          <td><pre><code>      </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">25</td>
          <td><pre><code>      # Need to be able to make each arg_name optional or not</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">26</td>
          <td><pre><code>      # and allow for type in future</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">27</td>
          <td><pre><code>      args.each do |i|</code></pre></td>
          <td><span class="count">29</span></td>
        </tr>
          <tr class="ran">
          <td class="no">28</td>
          <td><pre><code>        if i.is_a? String</code></pre></td>
          <td><span class="count">67</span></td>
        </tr>
          <tr class="ran">
          <td class="no">29</td>
          <td><pre><code>          if i =~ /\A(([A-Z0-9\[\]]+)\s?)+\Z/</code></pre></td>
          <td><span class="count">22</span></td>
        </tr>
          <tr class="ran">
          <td class="no">30</td>
          <td><pre><code>            i.split(' ').each do |arg|</code></pre></td>
          <td><span class="count">9</span></td>
        </tr>
          <tr class="ran">
          <td class="no">31</td>
          <td><pre><code>              type = String</code></pre></td>
          <td><span class="count">11</span></td>
        </tr>
          <tr class="ran">
          <td class="no">32</td>
          <td><pre><code>              if arg[0] == "["</code></pre></td>
          <td><span class="count">11</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">33</td>
          <td><pre><code>                @args << {</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">34</td>
          <td><pre><code>                  :name => arg[1..arg.length-2], </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">35</td>
          <td><pre><code>                  :optional => true,</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">36</td>
          <td><pre><code>                  :type => type</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">37</td>
          <td><pre><code>                }</code></pre></td>
          <td><span class="count">4</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">38</td>
          <td><pre><code>              else</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">39</td>
          <td><pre><code>                @args << {</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">40</td>
          <td><pre><code>                  :name => arg, </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">41</td>
          <td><pre><code>                  :optional => false, </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">42</td>
          <td><pre><code>                  :type => type</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">43</td>
          <td><pre><code>                }</code></pre></td>
          <td><span class="count">7</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">44</td>
          <td><pre><code>              end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">45</td>
          <td><pre><code>            end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">46</td>
          <td><pre><code>          else</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">47</td>
          <td><pre><code>            @desc = i</code></pre></td>
          <td><span class="count">13</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">48</td>
          <td><pre><code>          end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">49</td>
          <td><pre><code>        else</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">50</td>
          <td><pre><code>          if i.class == Symbol</code></pre></td>
          <td><span class="count">45</span></td>
        </tr>
          <tr class="ran">
          <td class="no">51</td>
          <td><pre><code>            @names << i.to_s </code></pre></td>
          <td><span class="count">42</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">52</td>
          <td><pre><code>          else</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">53</td>
          <td><pre><code>            @args = i</code></pre></td>
          <td><span class="count">3</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">54</td>
          <td><pre><code>          end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">55</td>
          <td><pre><code>        end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">56</td>
          <td><pre><code>      end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">57</td>
          <td><pre><code>      </code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">58</td>
          <td><pre><code>      if @args == []</code></pre></td>
          <td><span class="count">29</span></td>
        </tr>
          <tr class="ran">
          <td class="no">59</td>
          <td><pre><code>        @args = [{:name => "ARG", :optional => false, :type => String}]</code></pre></td>
          <td><span class="count">17</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">60</td>
          <td><pre><code>      end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">61</td>
          <td><pre><code></code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">62</td>
          <td><pre><code>      @block = block</code></pre></td>
          <td><span class="count">29</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">63</td>
          <td><pre><code>    end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">64</td>
          <td><pre><code>    </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">65</td>
          <td><pre><code>    # Runs the block that was given with an argument</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">66</td>
          <td><pre><code>    #</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">67</td>
          <td><pre><code>    # @param [Array] args arguments to pass to the block</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">68</td>
          <td><pre><code>    def run(args)</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="ran">
          <td class="no">69</td>
          <td><pre><code>      @block.call(*args)</code></pre></td>
          <td><span class="count">14</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">70</td>
          <td><pre><code>    end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">71</td>
          <td><pre><code>    </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">72</td>
          <td><pre><code>    # @return [String] summary for help</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">73</td>
          <td><pre><code>    def summary(width=30, prepend=5)</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="ran">
          <td class="no">74</td>
          <td><pre><code>      n = names_to_strings.join(', ')</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">75</td>
          <td><pre><code>      a = nil</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">76</td>
          <td><pre><code>      if @args[0].is_a? Hash</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">77</td>
          <td><pre><code>        a = @args.map {|i| i[:name]}.join(' ')</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="ran">
          <td class="no">78</td>
          <td><pre><code>        if @optional</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="unran">
          <td class="no">79</td>
          <td><pre><code>          n << " [#{a}]"</code></pre></td>
          <td><span class="count">0</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">80</td>
          <td><pre><code>        else</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">81</td>
          <td><pre><code>          n << " #{a}"</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">82</td>
          <td><pre><code>        end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">83</td>
          <td><pre><code>      else</code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">84</td>
          <td><pre><code>        n << " {" << @args.join(', ') << "}"</code></pre></td>
          <td><span class="count">1</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">85</td>
          <td><pre><code>      end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">86</td>
          <td><pre><code></code></pre></td>
          <td></td>
        </tr>
          <tr class="ran">
          <td class="no">87</td>
          <td><pre><code>      spaces = width-n.length</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">88</td>
          <td><pre><code>      spaces = 1 if spaces < 1</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">89</td>
          <td><pre><code>      s = spaces(spaces)</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">90</td>
          <td><pre><code>      p = spaces(prepend)</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="ran">
          <td class="no">91</td>
          <td><pre><code>      "#{p}#{n}#{s}#{@desc}"</code></pre></td>
          <td><span class="count">2</span></td>
        </tr>
          <tr class="excluded">
          <td class="no">92</td>
          <td><pre><code>    end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">93</td>
          <td><pre><code>    </code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">94</td>
          <td><pre><code>  end</code></pre></td>
          <td></td>
        </tr>
          <tr class="excluded">
          <td class="no">95</td>
          <td><pre><code>end</code></pre></td>
          <td></td>
        </tr>
      </table>
    </div>
    
    <footer>
      <span>Generated on 2010-09-17 10:00:35 +0100 with </span><a href="http://github.com/hawx/duvet">duvet 0.1.0
</a>
    </footer>
    
  </body>
</html>